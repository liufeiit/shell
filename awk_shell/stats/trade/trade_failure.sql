select * from ( select '2014-10-23' as '日期',count(*) as '失败总数' from ( select * from nova_user_trade as q where q.tradeStatus = 1 and q.createdAt < '2014-10-23 23:59:59' and q.createdAt >= '2014-10-23' ) as w1 )as q1, ( select sum(payAmount) as '金额' from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-23 23:59:59' and createdAt >= '2014-10-23' )as q5, ( select (count(*)) as 'Android' from nova_user_version b, (select * from (select * from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-23 23:59:59' and createdAt >= '2014-10-23') as t1) as t1 where t1.userId = b.userId and b.deviceType = 1 )as q2, ( select (count(*)) as 'iOS' from nova_user_version b, (select * from (select * from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-23 23:59:59' and createdAt >= '2014-10-23') as t1) as t1 where t1.userId = b.userId and b.deviceType = 0 )as q4, ( select count( case when tradeFrom=1 then 1 else null end) as '支付宝', count( case when tradeFrom=2 then 1 else null end) as 'appstore', count( case when tradeFrom=3 then 1 else null end) as '银联', count( case when tradeFrom=4 then 1 else null end) as '快用', count( case when tradeFrom=5 then 1 else null end) as 'sand' from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-23 23:59:59' and createdAt >= '2014-10-23' ) as q3;
select * from ( select '2014-10-24' as '日期',count(*) as '失败总数' from ( select * from nova_user_trade as q where q.tradeStatus = 1 and q.createdAt < '2014-10-24 23:59:59' and q.createdAt >= '2014-10-24' ) as w1 )as q1, ( select sum(payAmount) as '金额' from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-24 23:59:59' and createdAt >= '2014-10-24' )as q5, ( select (count(*)) as 'Android' from nova_user_version b, (select * from (select * from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-24 23:59:59' and createdAt >= '2014-10-24') as t1) as t1 where t1.userId = b.userId and b.deviceType = 1 )as q2, ( select (count(*)) as 'iOS' from nova_user_version b, (select * from (select * from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-24 23:59:59' and createdAt >= '2014-10-24') as t1) as t1 where t1.userId = b.userId and b.deviceType = 0 )as q4, ( select count( case when tradeFrom=1 then 1 else null end) as '支付宝', count( case when tradeFrom=2 then 1 else null end) as 'appstore', count( case when tradeFrom=3 then 1 else null end) as '银联', count( case when tradeFrom=4 then 1 else null end) as '快用', count( case when tradeFrom=5 then 1 else null end) as 'sand' from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-24 23:59:59' and createdAt >= '2014-10-24' ) as q3;
select * from ( select '2014-10-25' as '日期',count(*) as '失败总数' from ( select * from nova_user_trade as q where q.tradeStatus = 1 and q.createdAt < '2014-10-25 23:59:59' and q.createdAt >= '2014-10-25' ) as w1 )as q1, ( select sum(payAmount) as '金额' from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-25 23:59:59' and createdAt >= '2014-10-25' )as q5, ( select (count(*)) as 'Android' from nova_user_version b, (select * from (select * from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-25 23:59:59' and createdAt >= '2014-10-25') as t1) as t1 where t1.userId = b.userId and b.deviceType = 1 )as q2, ( select (count(*)) as 'iOS' from nova_user_version b, (select * from (select * from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-25 23:59:59' and createdAt >= '2014-10-25') as t1) as t1 where t1.userId = b.userId and b.deviceType = 0 )as q4, ( select count( case when tradeFrom=1 then 1 else null end) as '支付宝', count( case when tradeFrom=2 then 1 else null end) as 'appstore', count( case when tradeFrom=3 then 1 else null end) as '银联', count( case when tradeFrom=4 then 1 else null end) as '快用', count( case when tradeFrom=5 then 1 else null end) as 'sand' from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-25 23:59:59' and createdAt >= '2014-10-25' ) as q3;
select * from ( select '2014-10-26' as '日期',count(*) as '失败总数' from ( select * from nova_user_trade as q where q.tradeStatus = 1 and q.createdAt < '2014-10-26 23:59:59' and q.createdAt >= '2014-10-26' ) as w1 )as q1, ( select sum(payAmount) as '金额' from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-26 23:59:59' and createdAt >= '2014-10-26' )as q5, ( select (count(*)) as 'Android' from nova_user_version b, (select * from (select * from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-26 23:59:59' and createdAt >= '2014-10-26') as t1) as t1 where t1.userId = b.userId and b.deviceType = 1 )as q2, ( select (count(*)) as 'iOS' from nova_user_version b, (select * from (select * from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-26 23:59:59' and createdAt >= '2014-10-26') as t1) as t1 where t1.userId = b.userId and b.deviceType = 0 )as q4, ( select count( case when tradeFrom=1 then 1 else null end) as '支付宝', count( case when tradeFrom=2 then 1 else null end) as 'appstore', count( case when tradeFrom=3 then 1 else null end) as '银联', count( case when tradeFrom=4 then 1 else null end) as '快用', count( case when tradeFrom=5 then 1 else null end) as 'sand' from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-26 23:59:59' and createdAt >= '2014-10-26' ) as q3;
select * from ( select '2014-10-27' as '日期',count(*) as '失败总数' from ( select * from nova_user_trade as q where q.tradeStatus = 1 and q.createdAt < '2014-10-27 23:59:59' and q.createdAt >= '2014-10-27' ) as w1 )as q1, ( select sum(payAmount) as '金额' from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-27 23:59:59' and createdAt >= '2014-10-27' )as q5, ( select (count(*)) as 'Android' from nova_user_version b, (select * from (select * from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-27 23:59:59' and createdAt >= '2014-10-27') as t1) as t1 where t1.userId = b.userId and b.deviceType = 1 )as q2, ( select (count(*)) as 'iOS' from nova_user_version b, (select * from (select * from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-27 23:59:59' and createdAt >= '2014-10-27') as t1) as t1 where t1.userId = b.userId and b.deviceType = 0 )as q4, ( select count( case when tradeFrom=1 then 1 else null end) as '支付宝', count( case when tradeFrom=2 then 1 else null end) as 'appstore', count( case when tradeFrom=3 then 1 else null end) as '银联', count( case when tradeFrom=4 then 1 else null end) as '快用', count( case when tradeFrom=5 then 1 else null end) as 'sand' from nova_user_trade where tradeStatus = 1 and createdAt < '2014-10-27 23:59:59' and createdAt >= '2014-10-27' ) as q3;
