#!/bin/bash

for code in -1000 -10011 -10012 -10013 -1003 -11000 -11001 -11002 -11003 -11004 -11005 -11006 -12002 -13000 -13001 -13004 -13005 -13006 -13008 -2001 -2002 -2003 -2004 -2005 -2007 -2008 -2009 -2010 -2011 -2013 -2014 -2015 -2016 -2017 -2018 -2020 -2021 -4001 -4002 -4003 -4004 -4006 -4007 -5001 -6001 -7001 -7002 -7003 -8002 -8003 -9000 -9003 -9010 -9011 -9012 -9013 -9024 -9031 -9032 -9035 -9036 -9037 -9038 -9050 -9051 -9060 -9061 -9110 1000; do

awk -v code="$code" '
BEGIN{FS=","}
{
        data[$1,code] += $2;
}
END{
		i=0;
		line="";
		for(d in data){
			split(d, data2, SUBSEP);
			if(i==0) {
				line=(data2[1]);
			}
			print data2[1], data2[2], data[d];
		}
}
' /data/backup/user_access/server_return_code/code_${code}.csv >> code_tmp.csv

done

